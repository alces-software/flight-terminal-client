# Flight Launch

Flight Launch is a service provided by Alces Flight to quickly launch a
preconfigured Flight Compute cluster.

Flight Launch consists of three components: server, client and launch token
generator.  All of these components are contained in this repository, in the
`server`, `client` and `token-generator` directories.

## Getting started

The instructions below assume that docker is being used to run the server and
a client build environment.

If you are happy to use docker for development follow the instructions below.
If you don't want to use docker, then you will have to manually follow through
the steps in `bin/setup.sh`, `client/Dockerfile`, `server/Dockerfile`.  It
should be straight forward and you can document what happened here.


### Initial setup

First you need to copy and adapt the environment variables file suitably for
your local environment:

```bash
cp server/config/foreman/{dev.env,local.dev.env}
$EDITOR server/config/foreman/local.dev.env
```

At a minimum you will need to set the `AWS_ACCESS_KEY_ID` and
`AWS_SECRET_ACCESS_KEY`.


```bash
bin/setup.sh
```

### Starting the containers

Once the initial setup has been completed, you can run the client build server
and the web server in two separate terminals:

```bash
docker-compose up server
```

```bash
docker-compose up client
```

Flight Launch will then be accessible at `localhost:4002`.  Configuring the
port that Flight Launch runs on during development has been left as a future
enhancement.


## Launch tokens

Launch tokens are generated by the launch token generator.  This is a simple
webpage which creates entries in a DynamoDB.

### Creating a launch token

Instructions on creating a launch token can be [read
here](token-generator/GENERATING_TOKENS.md).

### Developing the launch token generator

The launch token generator consists of a few parts:

 1. A `flight-launch-token-generator.html.erb` file comprising the HTML form
    and the JavaScript.
 2. A number of `*.txt` files containing word lists and token generation
    rules.
 3. A Makefile.

To change the combinations of parts of speach that comprise a token, edit the
`combinations.txt` file.  Each line is a rule specifying how randomly selected
parts of speach are combined.

To change the words that can be used in a launch token, edit the appropriate
`*.txt` file.  Each line contains a single word (or phrase).

After each change the `flight-launch-token-generator.html` will need to be
regenerated by running `make` inside the `token-generator` directory.

A new version of the token generator can be made live by running `make
upload`.


## Cluster specs

Some documentation can be found
[here](client/src/modules/clusterSpecs/data/README-CLUSTER-SPECS.md).
